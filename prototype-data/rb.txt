-- https://medium.com/@qu1ck504t/create-a-table-in-postgresql-out-of-a-csv-using-atom-and-psql-1995719dd6f3

CREATE SCHEMA ml; 

CREATE TABLE ml.data2(); 

ALTER TABLE ml.data2 ADD player_id TEXT;
ALTER TABLE ml.data2 ADD player_name TEXT;
ALTER TABLE ml.data2 ADD position TEXT;
ALTER TABLE ml.data2 ADD nfl_year TEXT;
ALTER TABLE ml.data2 ADD season TEXT;
ALTER TABLE ml.data2 ADD week TEXT;
ALTER TABLE ml.data2 ADD game_date TEXT;
ALTER TABLE ml.data2 ADD home_or_away TEXT;
ALTER TABLE ml.data2 ADD opponent TEXT;
ALTER TABLE ml.data2 ADD outcome TEXT;
ALTER TABLE ml.data2 ADD score TEXT;
ALTER TABLE ml.data2 ADD games_played TEXT;
ALTER TABLE ml.data2 ADD games_started TEXT;
ALTER TABLE ml.data2 ADD receptions TEXT;
ALTER TABLE ml.data2 ADD receiving_yards TEXT;
ALTER TABLE ml.data2 ADD yards_per_reception TEXT;
ALTER TABLE ml.data2 ADD longest_reception TEXT;
ALTER TABLE ml.data2 ADD receiving_tds TEXT;
ALTER TABLE ml.data2 ADD rushing_attempts TEXT;
ALTER TABLE ml.data2 ADD rushing_yards TEXT;
ALTER TABLE ml.data2 ADD yards_per_carry TEXT;
ALTER TABLE ml.data2 ADD longest_rushing_run TEXT;
ALTER TABLE ml.data2 ADD rushing_tds TEXT;
ALTER TABLE ml.data2 ADD fumbles TEXT;
ALTER TABLE ml.data2 ADD fumbles_lost TEXT;

COPY ml.data2
(player_id,player_name,position,nfl_year,season,week,game_date,home_or_away,opponent,outcome,score,games_played,games_started,receptions,receiving_yards,yards_per_reception,longest_reception,receiving_tds,rushing_attempts,rushing_yards,yards_per_carry,longest_rushing_run,rushing_tds,fumbles,fumbles_lost) FROM '/workspace/prototype-data/rb_test.csv'